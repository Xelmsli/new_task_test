# Проект "MyApp"

Цей проект об’єднує два основних компоненти: застосунок та систему моніторингу. Ми використовуємо Docker для контейнеризації застосунку і сервісів моніторингу, а також docker-compose для спільного запуску всіх компонентів.

## Структура проекту


## Що робить наш Pipeline

Цей Jenkins Pipeline автоматизує весь цикл розгортання на віддаленому сервері, виконуючи наступні етапи:

1. **Checkout**  
   Клонується репозиторій з GitHub з використанням SSH-креденшалів.

2. **Transfer Code to Remote**  
   За допомогою `rsync` весь код копіюється на віддалений сервер у каталог `/opt/myapp`. Перед цим створюється потрібна директорія.

3. **Install Dependencies on Remote**  
   Через SSH перевіряється, чи встановлено Docker та Docker Compose v2. Якщо ні, то вони автоматично встановлюються (встановлюються пакети `docker.io` та `curl`, а також Docker Compose v2 завантажується з GitHub).

4. **Build on Remote**  
   Виконується побудова Docker-образів для всіх сервісів за допомогою команди: sudo docker compose -f docker-compose.yml build
5. **Deploy on Remote**  
За допомогою команди: sudo docker compose -f docker-compose.yml up -dзапускаються всі сервіси (застосунок, Prometheus, cAdvisor, Grafana та Node Exporter).

6. **Test WebApp on Remote**  
Виконується HTTP-запит до застосунку на порту 5000, щоб перевірити, чи застосунок працює та повертає статус 200.

7. **Restart on Remote** (опціонально)  
При виборі параметра "Рестарт" виконуються лише команди перезапуску контейнерів: sudo docker compose restart
8. **Backup and Shutdown** (опціонально)  
При виборі параметра "Бекап і свернути" виконується:
- Архівація всіх файлів з каталогу `/opt/myapp` (створюється архів із позначенням дати та часу).
- Зупинка всіх контейнерів за допомогою команди:
  ```
  sudo docker compose down
  ```

## Як запустити Pipeline

При запуску Pipeline в Jenkins вам буде запропоновано вибрати одну з опцій:
- **Запустити** – виконується повний цикл розгортання (checkout, передача коду, встановлення залежностей, збірка, розгортання, тестування).
- **Рестарт** – лише перезапуск контейнерів (без повторної збірки та встановлення залежностей).
- **Бекап і свернути** – створення резервної копії (бекапу) поточних файлів і зупинка контейнерів.

Це дозволяє гнучко керувати процесом розгортання, роблячи повний запуск, перезапуск або резервне копіювання і зупинку сервісів залежно від потреб.

## Додаткові примітки

- **Docker & Docker Compose:**  
Якщо можливо, рекомендується додати користувача, під яким запускаються команди (наприклад, `ubuntu`), до групи `docker` на віддаленому сервері, щоб не використовувати sudo для запуску docker-команд.

- **Моніторинг:**  
У Prometheus використовується конфігураційний файл `prometheus.yml` (розташований у каталозі `monitoring`), а дашборди Grafana можна налаштувати для відображення метрик з Prometheus.

- **Алертинг:**  
  Файл з правилами алертингу (alert.rules.yml)


  Лог файл зборки та скріншот графани знаходиться в папці звіт !!!!!

Цей README.md надає загальний опис файлів проекту та пояснює, як працює автоматизований процес розгортання через Jenkins Pipeline.




